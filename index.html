<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tetris</title>
</head>

<body>
  <canvas id="canvasId"></canvas>
  <script>
    const field_vertical = 20  //縦
    const field_beside = 10 //横
    const block_size = 30
    const canvas_vertical = field_vertical * block_size
    const canvas_beside = field_beside * block_size
    const tetro_size = 4
    let canvasId = document.getElementById('canvasId')
    let conText = canvasId.getContext('2d')
    canvasId.width = canvas_beside
    canvasId.height = canvas_vertical
    canvasId.style.border = '4px solid #555'
    
    const drawBlock = (x,y) => {
        let px = x * block_size
        let py = y * block_size
        conText.fillStyle = 'red'
        conText.fillRect(px, py, block_size, block_size)
        conText.strokeStyle = 'black'
        conText.strokeRect(px, py, block_size, block_size)
      }
    
    class Tetromino{
      constructor(x,y){
        //テトロミノの座標
        this.tetro_x = x
        this.tetro_y = y
        this. tetroType = Math.floor(Math.random() * 2)
      }
      createTetroMino(){
        for (let y = 0; y < tetro_size; y++) {
          for (let x = 0; x < tetro_size; x++) {
            if (tetros[this.tetroType][y][x]) {
              drawBlock(this.tetro_x + x,this.tetro_y + y)
            }
          }
        }
      }
      
      moveTetroMino(){
        document.addEventListener('keydown',(e)=>{
          console.log(this.tetro_x)
          console.log(this.tetro_y)
          conText.clearRect(0,0, canvas_beside, canvas_vertical)
          switch(e.keyCode){
            case 37 : //左
            this.tetro_x--
            this.createTetroMino()
            break
            case 38: //上
            this.tetro_y--
            this.createTetroMino()
            break
            case 39 : //右
            this.tetro_x++
            this.createTetroMino()
            break
            case 40 :  //下
            this.tetro_y++
            this.createTetroMino()
            break
          } 
        })
      }
    }
  const tetros = [
    //テトロT
    [
      [0, 0, 0, 0],
      [1, 1, 1, 0],
      [0, 1, 0, 0],
      [0, 0, 0, 0],
    ],
    //テトロL
    [
      [0, 1, 0, 0],
      [0, 1, 0, 0],
      [0, 1, 1, 0],
      [0, 0, 0, 0],
    ]
  ]

  const tetro1 = new Tetromino(8,8)
  tetro1.createTetroMino()
  tetro1.moveTetroMino()
  
  
  class Board {
    constructor(){
      this.field =[]
      for(let row = 0; row < field_vertical; row++){
        this.field[row] = []
        for(let col = 0; col < field_beside; col++){
          this.field[row][col] = 0
        }
      }
      this.field_vertical = 20
      this.field_beside = 10
    }
    makeBoard(){
      for(let row = 0; row < this.field_vertical; row++){
        for(let col = 0; col < this.field_beside; col++){
          if (this.field[row][col]) {
            drawBlock(col,row)
          }
        }
      } 
    }
  }
  const board = new Board()
  board.makeBoard()
  
  
  </script>
</body>
</html>